@startuml
' Main components
package "VS Code Extension" {
  [Extension Host] as ExtHost
  [Commands] as Commands
  [Context Manager] as ContextManager
  [AI Provider] as AIProvider
  [Chat View] as ChatView
}

' External components
cloud "Anthropic API" as AnthropicAPI

' User interactions
actor User

' Relationships and flow
User --> ExtHost : Interacts with
ExtHost --> Commands : Registers
Commands --> ContextManager : Uses
Commands --> AIProvider : Uses
Commands --> ChatView : Creates

ChatView --> User : Displays UI
ChatView --> ContextManager : Gets context
ChatView --> AIProvider : Sends prompts

ContextManager --> [File System] : Reads files
ContextManager --> [VS Code API] : Gets workspace info

AIProvider --> AnthropicAPI : Sends requests
AnthropicAPI --> AIProvider : Returns responses
AIProvider --> ChatView : Streams responses

' Main flow
note right of User
  1. User opens VS Code with AI Coder extension
  2. User selects context (files/folders)
  3. User enters prompt in Chat View
  4. Extension processes context
  5. AI Provider sends request to Anthropic
  6. Response is streamed back to user
end note

' Context Manager details
note bottom of ContextManager
  - Manages selected files/folders
  - Analyzes directory structures
  - Scores files by relevance
  - Handles gitignore rules
  - Processes images
end note

' AI Provider details
note bottom of AIProvider
  - Handles API authentication
  - Prepares context for AI
  - Processes streaming responses
  - Manages conversation history
end note
@enduml